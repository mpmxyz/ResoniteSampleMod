on:
  workflow_dispatch:
    inputs:
      version:
        type: string
        required: true
        description: "Version"
        #TODO: add check for proper formatting - [0-9]+.[0-9]+.[0-9]+
      name:
        type: string
        required: true
        description: "Title"
      description:
        type: string
        required: true
        description: "Description"
        default: ""
  #TODO: create automatic trigger from pushed git tag v[0-9]+.[0-9]+.[0-9]+
name: "Create Release"
jobs:
  compile:
    uses: ./.github/workflows/build.yml
    with:
      UPLOAD_ARTIFACTS: true
      BUILD_VERSION: ${{ inputs.version }}
  create-release:
    runs-on: ubuntu-latest
    needs: compile
    steps:
      - uses: "ncipollo/release-action@v1.13.0"
        with:
          artifactErrorsFailBuild: true
          artifacts: "*.dll,*.zip,*.nupkg"
          body: ${{ inputs.description }}
          name: ${{ inputs.name }}
          tag: "v${{ inputs.version }}"
          commit: ${{ github.ref }}
      - run: |
          echo "TODO: move nupkg upload here"
